<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 4 Outbreak Analysis | Pathogen Genomic Epidemiology 2025</title>
  <meta name="description" content="Workshop website for the 2025 Pathogen Genomic Epidemiology Canadian Bioinformatics Workshop" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 4 Outbreak Analysis | Pathogen Genomic Epidemiology 2025" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bioinformaticsdotca.github.io/PGE_2025/img/bioinformatics_logo.png" />
  <meta property="og:description" content="Workshop website for the 2025 Pathogen Genomic Epidemiology Canadian Bioinformatics Workshop" />
  <meta name="github-repo" content="bioinformaticsdotca/PGE_2025" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 4 Outbreak Analysis | Pathogen Genomic Epidemiology 2025" />
  
  <meta name="twitter:description" content="Workshop website for the 2025 Pathogen Genomic Epidemiology Canadian Bioinformatics Workshop" />
  <meta name="twitter:image" content="https://bioinformaticsdotca.github.io/PGE_2025/img/bioinformatics_logo.png" />

<meta name="author" content="Faculty: Angela McLaughlin, Emma Griffiths, Finlay Maguire, Gary Van Domselaar, Idowu Olawoye, Jennifer Guthrie, Zhibin Lu, Charlie Barclay," />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
<link rel="prev" href="module-3-pathogen-typing.html"/>
<link rel="next" href="module-5-phylodynamics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "name": "Pathogen Genomic Epidemiology",
  "description": "The complete set of tutorials, slides, and practical exercises for the Pathogen Genomic Epidemiology 2025 Canadian Bioinformatics Workshop, hosted on GitHub Pages.",
  "url": "https://bioinformaticsdotca.github.io/PGE_2025",
  "learningResourceType": ["tutorial", "slides", "exercise"],
  "inLanguage": "en",
  "license": "https://creativecommons.org/licenses/by/4.0/",
  "provider": {
    "@type": "Organization",
    "name": "Bioinformatics.ca",
    "url": "https://bioinformatics.ca"
  },
  "keywords": "",
  "isPartOf": {
    "@type": "Course",
    "@id": "https://bioinformatics.ca/workshops-all/2025-pathogen-genomic-epidemiology-online/"
  }
}
</script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://bioinformaticsdotca.github.io/">
 <img src="img/bioinformatics_logo.png" width="90%" alt="bioinformatics.ca logo" style="display:block; margin-left:auto; margin-right:auto; margin-top:15px;">
 </a>
<li><center><strong><a href="./"><br><br><br></a></strong></center></li>
<a href="./">
 <img src="img/pge-icon.png" width="70%" alt=" logo" style="display:block; margin-left:auto; margin-right:auto; ">
 </a>
<br>

<li class="divider"></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Workshop Info</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pre-work"><i class="fa fa-check"></i>Pre-work</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#class-photo"><i class="fa fa-check"></i>Class Photo</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="meet-your-faculty.html"><a href="meet-your-faculty.html"><i class="fa fa-check"></i>Meet Your Faculty</a></li>
<li class="chapter" data-level="" data-path="data-and-compute-setup.html"><a href="data-and-compute-setup.html"><i class="fa fa-check"></i>Data and Compute Setup</a></li>
<li class="chapter" data-level="" data-path="module-1-data-curation-and-data-sharing.html"><a href="module-1-data-curation-and-data-sharing.html"><i class="fa fa-check"></i>Module 1 Data Curation and Data Sharing</a>
<ul>
<li class="chapter" data-level="" data-path="module-1-data-curation-and-data-sharing.html"><a href="module-1-data-curation-and-data-sharing.html#lecture"><i class="fa fa-check"></i>Lecture</a></li>
<li class="chapter" data-level="" data-path="module-1-data-curation-and-data-sharing.html"><a href="module-1-data-curation-and-data-sharing.html#lab"><i class="fa fa-check"></i>Lab</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-2-emerging-pathogen-detection-and-identification.html"><a href="module-2-emerging-pathogen-detection-and-identification.html"><i class="fa fa-check"></i>Module 2 Emerging Pathogen Detection and Identification</a>
<ul>
<li class="chapter" data-level="" data-path="module-2-emerging-pathogen-detection-and-identification.html"><a href="module-2-emerging-pathogen-detection-and-identification.html#lecture-1"><i class="fa fa-check"></i>Lecture</a></li>
<li class="chapter" data-level="" data-path="module-2-emerging-pathogen-detection-and-identification.html"><a href="module-2-emerging-pathogen-detection-and-identification.html#lab-1"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="module-2-emerging-pathogen-detection-and-identification.html"><a href="module-2-emerging-pathogen-detection-and-identification.html#copy-data-files"><i class="fa fa-check"></i>3.1. Copy data files</a></li>
<li class="chapter" data-level="" data-path="module-2-emerging-pathogen-detection-and-identification.html"><a href="module-2-emerging-pathogen-detection-and-identification.html#activate-environment"><i class="fa fa-check"></i>3.2. Activate environment</a></li>
<li class="chapter" data-level="" data-path="module-2-emerging-pathogen-detection-and-identification.html"><a href="module-2-emerging-pathogen-detection-and-identification.html#verify-your-workshop-machine-url"><i class="fa fa-check"></i>3.3. Verify your workshop machine URL</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-3-pathogen-typing.html"><a href="module-3-pathogen-typing.html"><i class="fa fa-check"></i>Module 3 Pathogen Typing</a>
<ul>
<li class="chapter" data-level="" data-path="module-3-pathogen-typing.html"><a href="module-3-pathogen-typing.html#lecture-2"><i class="fa fa-check"></i>Lecture</a></li>
<li class="chapter" data-level="" data-path="module-3-pathogen-typing.html"><a href="module-3-pathogen-typing.html#lab-2"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="module-3-pathogen-typing.html"><a href="module-3-pathogen-typing.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="module-3-pathogen-typing.html"><a href="module-3-pathogen-typing.html#part-one-chewbbaca-objective"><i class="fa fa-check"></i>PART ONE: chewBBACA Objective</a></li>
<li class="chapter" data-level="" data-path="module-3-pathogen-typing.html"><a href="module-3-pathogen-typing.html#part-two-cgmlst-clustering-objective"><i class="fa fa-check"></i>PART TWO: cgMLST clustering Objective</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-4-outbreak-analysis.html"><a href="module-4-outbreak-analysis.html"><i class="fa fa-check"></i>Module 4 Outbreak Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="module-4-outbreak-analysis.html"><a href="module-4-outbreak-analysis.html#lecture-3"><i class="fa fa-check"></i>Lecture</a></li>
<li class="chapter" data-level="" data-path="module-4-outbreak-analysis.html"><a href="module-4-outbreak-analysis.html#lab-3"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="module-4-outbreak-analysis.html"><a href="module-4-outbreak-analysis.html#background"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="module-4-outbreak-analysis.html"><a href="module-4-outbreak-analysis.html#set-up"><i class="fa fa-check"></i>Set-Up</a></li>
<li class="chapter" data-level="" data-path="module-4-outbreak-analysis.html"><a href="module-4-outbreak-analysis.html#cluster-identification"><i class="fa fa-check"></i>Cluster Identification</a></li>
<li class="chapter" data-level="" data-path="module-4-outbreak-analysis.html"><a href="module-4-outbreak-analysis.html#snp-analysis"><i class="fa fa-check"></i>SNP Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-5-phylodynamics.html"><a href="module-5-phylodynamics.html"><i class="fa fa-check"></i>Module 5 Phylodynamics</a>
<ul>
<li class="chapter" data-level="" data-path="module-5-phylodynamics.html"><a href="module-5-phylodynamics.html#lecture-4"><i class="fa fa-check"></i>Lecture</a></li>
<li class="chapter" data-level="" data-path="module-5-phylodynamics.html"><a href="module-5-phylodynamics.html#lab-4"><i class="fa fa-check"></i>Lab</a></li>
</ul></li>
<li class="divider"></li>
<h1 id="sponsors">Sponsors</h1>
<center>
<a href="https://www.cihr-irsc.gc.ca"><img src="img/sponsors/cihr.png" width=90% style="padding-bottom: 20px" alt="Canadian Institutes of Health Research logo."></a>

<a href="https://genomecanada.ca/"><img src="img/sponsors/genomecanada.png" height="55" style="display:inline-block;"  style="padding-bottom: 20px" alt="Genome Canada logo.">
<a href="https://www.ontariogenomics.ca/"><img src="img/sponsors/ontariogenomics.png" height="55" style="display:inline-block;" style="padding-bottom: 20px;" alt="Ontario Genomics logo.">
<br><br>
<a href="https://oicr.on.ca/"><img src="img/sponsors/oicr.png" width=35% style="display:inline-block;" style="padding-bottom: 20px" alt="Ontario Institute for Cancer Research logo.">
<br><br>
<a href="https://uhn.ca/"><img src="img/sponsors/uhnlogo.png" width=55% style="display:inline-block;" style="padding-bottom: 20px" alt="University Health Network logo.">

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pathogen Genomic Epidemiology 2025</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="module-4-outbreak-analysis" class="section level1 hasAnchor">
<h1>Module 4 Outbreak Analysis<a href="module-4-outbreak-analysis.html#module-4-outbreak-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Author: Finlay Maguire</em></p>
<p><em>Last Modified: 2025-11-11</em></p>
<div id="lecture-3" class="section level2 hasAnchor">
<h2>Lecture<a href="module-4-outbreak-analysis.html#lecture-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Link to PDF of slides from google</p>
</div>
<div id="lab-3" class="section level2 hasAnchor">
<h2>Lab<a href="module-4-outbreak-analysis.html#lab-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><a href="#intro">Background</a></li>
<li><a href="#setup">Setup</a></li>
<li><a href="#cluster">Cluster Identification</a></li>
<li><a href="#snp">SNP Analysis</a></li>
<li><a href="#trans">Transmission Inference</a></li>
</ol>
<p>In this lab practical we will be using microbial genomes (and associated contextual metadata) to investigate a suspected nosocomial (hospital-acquired) outbreak of <em>Methicillin resistance Staphylococcus aureus</em> (MRSA) in a UK-based Neonatal Intensive Care Unit (NICU). The data we are using comes from a classic study which demonstrated the utility of whole genome sequencing for investigating an MRSA outbreak within a Special Care Baby Unit (also known as a NICU) of the Cambridge University Hospitals NHS Foundation Trust (CUH).</p>
<blockquote>
<p>Harris SR, Cartwright EJP, Török ME, et al. Whole-genome sequencing for analysis of an outbreak of methicillin-resistant Staphylococcus aureus: a descriptive study. <em>Lancet Infect Dis</em> 2012 <a href="http://dx.doi.org/10.1016/S1473-3099(12)70268-2">10.1016/S1473-3099(12)70268-2</a></p>
</blockquote>
<p>This practical will step you through the genomic components of a typical nosocomial bacterial outbreak investigation, specifically:</p>
<ul>
<li>Identifying potential outbreak clusters</li>
<li>Determining SNP distances</li>
<li>Inferring outbreak phylogenies</li>
<li>Performing transmission inference</li>
</ul>
<p><a name="intro"></a></p>
<div id="background" class="section level3 hasAnchor">
<h3>Background<a href="module-4-outbreak-analysis.html#background" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Staphylococcus aureus</em> is a Gram-positive coccoidal bacteria that forms a normal commensal member of the microbiome in 20-40% of people (<a href="https://doi.org/10.1016/j.ijmm.2016.11.007">Karsten, 2017</a>). However, when skin and mucosal barriers are disrupted (e.g., through medical procedures such as catheterisation, tracheal tubes, surgeries) <em>S. aureus</em> can cause opportunistic invasive infections (<a href="https://doi.org/10.1038/nrdp.2018.33">Lee, 2018</a>).</p>
<p>Since the 1960s, variants have emerged and spread globally that are resistant to the majority of β-lactam antibiotics through the independent acquisitions of the staphylococcal cassette chromosome mec (SCCmec) (<a href="https://doi.org/10.1128/AAC.00579-09">IWG-SSC, 2009</a>. This combination of commensal carriage, antimicrobial resistance, and healthcare-associated infection opportunities (along with additional virulence factors) have led to MRSA becoming a leading cause of hospital-associated mortality and morbidity globally (<a href="https://doi.org/10.1016/s0140-6736(24)01867-1">GBD, 2024</a>). Therefore, tracking and preventing MRSA outbreaks is a major priority for infection prevention and control (IPAC or IPC) within hospital settings especially within the NICU due to the vulnerability of immunocompromised preterm infants and the high frequency of invasive procedures.
This has led to adoption of genomic epidemiological approaches to detect MRSA outbreaks and track transmission links not apparent from traditional approaches alone (<a href="https://doi.org/10.1099/mgen.0.001235">Blane, 2024</a>). These sort of outbreak investigations are generally led by the infection prevention &amp; control (IPAC or IPC) team in a clinical setting or by the relevant public health team depending on the suspected infection source, geographic scale, and regional resource availability (e.g., Public Health Agency of Canada/Canadian Food Inspection Agency or provincial bodies like Public Health Ontario).</p>
<p>Within the SCBU/NICU of Cambridge University Hopitals NHS Trust (and most hospitals) all inpatients are screened for MRSA carriage upon admission and once per week thereafter using culture-based or nucleic-acid based test. Specific IPAC policies and guidelines will determine criteria for initiating an outbreak investigation (e.g., a certain number of positive screens within a specific time and/or location).</p>
<p>Routine surveillance has identified that 3 infants within the SCBU/NICU (P11-P13) are positive for MRSA carriage at the same time. Isolates from these 3 infants have also been shown to have the same pattern of antibiotic resistances. The IPAC team has therefore been activated to further investigate this as a suspected outbreak in the SCBU/NICU at CUH.
They have performed a systematic review of all MRSA isolates from the SCBU/NICU over the preceding 6-12 months and identified a series of overlapping MRSA carriages with this same set of resistances. Due to multi-week gaps in the positive SCBU/NICU isolates they have also collected potentially matching MRSA isolates from parents and the wider hospital/community. To gain better insight into this potential outbreak and identify which of these isolates are linked by direct transmission chains, CUH have sequenced these isolates using 150bp paired-end reads via an Illumina MiSeq platform.</p>
<div class="callout-purple">
<span class="callout-icon"><i class="fas fa-star" aria-hidden="true"></i></span>
<div class="callout-content">
<p>You are a clinical bioinformatician who has been asked to support the investigation and analyses these genomes</p>
</div>
</div>
<p><a name="setup"></a></p>
</div>
<div id="set-up" class="section level3 hasAnchor">
<h3>Set-Up<a href="module-4-outbreak-analysis.html#set-up" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This lab practical will involve running the following software:</p>
<ul>
<li><a href="https://github.com/tseemann/mlst">mlst</a></li>
<li><a href="https://github.com/bacpop/PopPUNK">poppunk</a></li>
<li><a href="https://github.com/bacpop/ska.rust">ska</a></li>
<li><a href="https://github.com/nickjcroucher/gubbins">gubbins</a></li>
<li><a href="https://github.com/iqtree/iqtree3">IQTree</a></li>
<li><a href="https://graphsnp.fordelab.com/">GraphSNP</a></li>
</ul>
<details class="callout-dropdown callout-subtle callout-blue-subtle"><summary class="callout-dropdown-summary"><i class="fas fa-circle-info" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<span class="callout-dropdown-title">Note: Bioinformatics in Practice</span> <span class="callout-dropdown-caret"><i class="fas fa-chevron-right" aria-hidden="true"></i></span></summary><div class="callout-dropdown-content"><p>Typically, most of these analyses would be run using a workflow such
as <a href="https://bactopia.github.io/latest/">bactopia</a> that you
are confident will reproducibly generate validated and verified outputs
(ideally as part of your institution’s ISO15189 accreditation or
equivalent). We will run the tools directly today so you get insight
into what these workflows are actually doing!</p></div></details>
<div id="data" class="section level4 hasAnchor">
<h4>Data<a href="module-4-outbreak-analysis.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using ssh connect to the provided analysis server instance:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb51-1"><a href="module-4-outbreak-analysis.html#cb51-1" tabindex="-1"></a><span class="fu">ssh</span> <span class="at">-i</span> YOUR_KEY.pem YOUR_USER@XX.uhn-hpc.ca</span></code></pre></div>
<p>Now create a folder in your <code>~/workspace</code> and copy/link over the files you will need:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="module-4-outbreak-analysis.html#cb52-1" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ~/workspace/module4</span>
<span id="cb52-2"><a href="module-4-outbreak-analysis.html#cb52-2" tabindex="-1"></a><span class="bu">cd</span> ~/workspace/module4</span>
<span id="cb52-3"><a href="module-4-outbreak-analysis.html#cb52-3" tabindex="-1"></a><span class="fu">cp</span> <span class="at">-r</span> ~/CourseData/module4/contextual_data.csv  ~/CourseData/module4/SASCBU26_reference.fna .</span>
<span id="cb52-4"><a href="module-4-outbreak-analysis.html#cb52-4" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> ~/CourseData/module4/assemblies .</span></code></pre></div>
<details class="callout-dropdown callout-subtle callout-blue-subtle"><summary class="callout-dropdown-summary"><i class="fas fa-circle-info" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<span class="callout-dropdown-title">Note: Contextual Data ‘Interpolation’</span> <span class="callout-dropdown-caret"><i class="fas fa-chevron-right" aria-hidden="true"></i></span></summary><div class="callout-dropdown-content"><p>Specific collection dates were not available so have been inferred
based on relative sampling gaps</p></div></details>
<p>When you are finished with these steps you should be inside your work directory <code>~/workspace/module4</code>. You can verify this by running the command <code>pwd</code>.
s
<strong>Output after running <code>pwd</code></strong></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb53-1"><a href="module-4-outbreak-analysis.html#cb53-1" tabindex="-1"></a><span class="ex">~/workspace/module4</span></span></code></pre></div>
<p>You now see an <code>assemblies/</code> folder in the current directory along with a <code>contextual_metadata.tsv</code> (all the contextual data needed for this analysis) and <code>SASCBU26_reference.fna</code> (the reference genome we will use later):</p>
<p><strong>Output after running <code>ls</code></strong>s</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="module-4-outbreak-analysis.html#cb54-1" tabindex="-1"></a><span class="ex">SASCBU26_reference.fna</span>  assemblies  contextual_data.csv</span></code></pre></div>
</div>
<div id="activate-environment-1" class="section level4 hasAnchor">
<h4>Activate environment<a href="module-4-outbreak-analysis.html#activate-environment-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next we will activate the pre-installed <a href="https://docs.conda.io/en/latest/">conda</a> environment, which will have all the tools needed by this tutorial pre-installed. To do this please run the following:</p>
<p><strong>Commands</strong></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb55-1"><a href="module-4-outbreak-analysis.html#cb55-1" tabindex="-1"></a><span class="ex">conda</span> activate outbreak</span></code></pre></div>
<p>You should see the command-prompt (where you type commands) switch to include <code>(outbreak)</code> at the beginning, showing you are inside this environment. You should also be able to run the <code>mlst</code> command like <code>mlst --version</code> and see output:</p>
<p><strong>Output after running <code>mlst --version</code></strong></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb56-1"><a href="module-4-outbreak-analysis.html#cb56-1" tabindex="-1"></a><span class="ex">mlst</span> 2.23.0</span></code></pre></div>
</div>
<div id="find-your-ip-address" class="section level4 hasAnchor">
<h4>Find your IP address<a href="module-4-outbreak-analysis.html#find-your-ip-address" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Similar to yesterday, we will want to either use the assigned hostname (e.g., xx.uhn-hpc.ca where xx is your instance number) or find the IP address of your machine on AWS so we can access some files from your machine on the web browser. To find your IP address you can run:</p>
<p><strong>Commands</strong></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="module-4-outbreak-analysis.html#cb57-1" tabindex="-1"></a><span class="ex">curl</span> http://checkip.amazonaws.com</span></code></pre></div>
<p>This should print a number like XX.XX.XX.XX. Once you have your address, try going to <a href="http://xx.uhn-hpc.ca" class="uri">http://xx.uhn-hpc.ca</a> or <a href="http://IP-ADDRESS" class="uri">http://IP-ADDRESS</a> and clicking the link for <strong>module4</strong>. This page will be referred to later to easily download/view some of our output files.</p>
<p><a name="cluster"></a></p>
</div>
</div>
<div id="cluster-identification" class="section level3 hasAnchor">
<h3>Cluster Identification<a href="module-4-outbreak-analysis.html#cluster-identification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All isolates that are putatively linked to the outbreak have been done so on the basis of time, location, and phenotype (specifically antibiotic susceptibilities). However, just because 2 isolates have the same resistance pattern does not mean they are closely related.
Although this is a relatively small set of isolates we are often evaluating very large numbers of genomes for their potential connection to an outbreak.
Additionally, most downstream outbreak analyses (such as transmission inference) perform best when applied to as little diversity as possible (i.e., just genomes from a single outbreak event).</p>
<p>This means our first task is to identify and group which isolates are actually connect</p>
<p>are likely to be linked using the sort of typing methods you encountered in the previous lab practical.
This helps us to eliminate unrelated genomes and determine whether 1 or more outbreaks are likely to be taking place.</p>
<p>To make things faster for this practical, we have provided pre-inferred genome assemblies (generated using <a href="https://github.com/tseemann/shovill">shovill</a> with the <a href="https://github.com/ncbi/SKESA">skesa</a> assembler).</p>
<p>You can infer the 7-gene MLST using the <a href="https://pubmlst.org/organisms/staphylococcus-aureus">pubMLST <em>Staphylococcus aureus</em> scheme</a> by running the <code>mlst</code> tool on each of the genome assemblies.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb58-1"><a href="module-4-outbreak-analysis.html#cb58-1" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> outbreak_cluster_identification<span class="kw">;</span> <span class="bu">cd</span> outbreak_cluster_identification</span>
<span id="cb58-2"><a href="module-4-outbreak-analysis.html#cb58-2" tabindex="-1"></a><span class="ex">mlst</span> <span class="at">--scheme</span> saureus ../assemblies/<span class="pp">*</span>.fa <span class="op">&gt;</span> mlst.tsv</span></code></pre></div>
<p>Now download the <code>mlst.tsv</code> output file (using either <code>scp</code> or the IP address listed above) and open it in your tabular data tool of choice (e.g., pandas/python, R, excel).</p>
<p><strong>Based on these results, which genomes do you suspect may not be part of this outbreak?</strong></p>
<details class="callout-dropdown callout-green"><summary class="callout-dropdown-summary"><i class="fas fa-circle-check" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<span class="callout-dropdown-title">Answer</span> <span class="callout-dropdown-caret"><i class="fas fa-chevron-right" aria-hidden="true"></i></span></summary><div class="callout-dropdown-content"><ul>
<li>P27 &amp; P28 have different MLSTs (ST1 and ST8) to any other genome
so unlikely to be linked to an outbreak.</li>
<li>P29 &amp; P34-38 (with P37 a partial match) could be an ST22
outbreak.</li>
<li>P30-33 could be an ST772 outbreak.</li>
<li>All remaining isolates belong to a large ST2731 set</li>
</ul></div></details>
<p><strong>Why might genomes with a different MLST still be closely related or those with the same MLST be relatively unrelated?</strong></p>
<details class="callout-dropdown callout-green"><summary class="callout-dropdown-summary"><i class="fas fa-circle-check" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<span class="callout-dropdown-title">Answer</span> <span class="callout-dropdown-caret"><i class="fas fa-chevron-right" aria-hidden="true"></i></span></summary><div class="callout-dropdown-content"><p>MLST are only 7 genes so a small amount of mutation (or
conservation!) in just these genes can lead to a totally different MLST
- schemes are designed to try and be robust but are mutation is a random
process with high variance!</p></div></details>
<p>We could solve this challenge using a more fine-grained scheme like cg/wgMLST (as discussed in the previous module) but we are going to use <code>poppunk</code> in this lab.</p>
<p><code>poppunk</code> is a rapid k-mer based genome clustering tool that groups genomes together based on both their core and accessory genome distances. This allows differential clustering of similar genomes which have acquired novel plasmids and so on.</p>
<p>The developers of poppunk provide some pre-computed databases (although it is relatively easy to create your own) for different species which are available <a href="https://www.bacpop.org/poppunk-databases/">here</a>.</p>
<p>We have already downloaded a reference database for you, so all you have to do is prepare a 2-column file <code>genomes.txt</code> which has a series of names in the first column and the path to the related genome assembly in the other.
We can do this using a quick bash one-line loop:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb59-1"><a href="module-4-outbreak-analysis.html#cb59-1" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> ../assemblies/<span class="pp">*</span>.fa<span class="kw">;</span> <span class="cf">do</span> <span class="va">isolate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span> <span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span> <span class="st">&#39;.&#39;</span> <span class="at">-f1</span><span class="va">)</span><span class="kw">;</span> <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">$isolate</span><span class="st">\t</span><span class="va">$i</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> genomes.txt<span class="kw">;</span> <span class="cf">done</span></span></code></pre></div>
<p>Then we can run the following to get poppunk cluster assignments:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb60-1"><a href="module-4-outbreak-analysis.html#cb60-1" tabindex="-1"></a><span class="ex">poppunk_assign</span> <span class="at">--db</span> ~/CourseData/module4/staphylococcus_aureus_v1_full <span class="at">--query</span> genomes.txt <span class="at">--output</span> poppunk</span></code></pre></div>
<p>Now download/inspect <code>poppunk/poppunk_clusters.csv</code> file</p>
<p><strong>Which genomes does this analysis suggest should be excluded? Do they match the MLST results?</strong></p>
<details class="callout-dropdown callout-green"><summary class="callout-dropdown-summary"><i class="fas fa-circle-check" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<span class="callout-dropdown-title">Answer</span> <span class="callout-dropdown-caret"><i class="fas fa-chevron-right" aria-hidden="true"></i></span></summary><div class="callout-dropdown-content"><p>P27-28 are assigned to cluster 1 and P30-33 are assigned cluster 12.
Remaining samples are assigned to cluster 3.</p>
<ul>
<li>P27 and P28 were different singleton STs for MLST that share a few
alleles so supports eliminating them</li>
<li>P30-33 were ST772 so poppunk and MLST agree and support eliminating
these samples (although they could be their own distinct outbreak)</li>
<li>ST22 and ST2731 isolates were both assigned to cluster 3. If we look
carefully at the MLST profile for these STs in <code>mlst.tsv</code> we
can see that these STs only differ by a single allele (arcC) so could be
linked in the main outbreak.</li>
</ul>
<p>We can’t be sure about cluster 3 without further analysis but we can
drop cluster 1 and 12 for now.</p></div></details>
<p><a name="snp"></a></p>
</div>
<div id="snp-analysis" class="section level3 hasAnchor">
<h3>SNP Analysis<a href="module-4-outbreak-analysis.html#snp-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have eliminated some isolates that are unlikely to be connected to our main outbreak we can do a deeper analysis of the evolutionary relationships between our isolates. For this we are going to perform a phylogenetic analysis. There are several way this could be done:</p>
<ul>
<li>Inferring and aligning the core genome of our isolates by running a tool like <code>panaroo</code> on the genome assembly annotation files (generated with <code>prokka</code> or <code>bakta</code>).</li>
<li>Mapping individual reads against a reference genome with a tool like <code>snippy</code>.</li>
<li>Mapping SNPs between genomes using <code>ska</code> (then using a reference to order these SNPs)</li>
</ul>
<p><strong>For SNP analyses, why might we want use a reference derived from an outbreak isolate instead of standard species reference genome?</strong></p>
<details class="callout-dropdown callout-green"><summary class="callout-dropdown-summary"><i class="fas fa-circle-check" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<span class="callout-dropdown-title">Answer</span> <span class="callout-dropdown-caret"><i class="fas fa-chevron-right" aria-hidden="true"></i></span></summary><div class="callout-dropdown-content"><p>We maximise the number of detectable SNPs by using a reference as
close as possible to our other genomes</p></div></details>
<p>For this lab, we are going to do the last option using a complete high quality reference genome generated from this outbreak subsequent to the original manuscript: SASCBU26</p>
<p>First let’s generate the input file for SKA using the poppunk results</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb61-1"><a href="module-4-outbreak-analysis.html#cb61-1" tabindex="-1"></a><span class="bu">cd</span> ~/workspace/module4<span class="kw">;</span> <span class="fu">mkdir</span> <span class="at">-p</span> ska_phylogeny<span class="kw">;</span> <span class="bu">cd</span> ska_phylogeny</span>
<span id="cb61-2"><a href="module-4-outbreak-analysis.html#cb61-2" tabindex="-1"></a><span class="fu">paste</span> <span class="op">&lt;(</span><span class="fu">grep</span> <span class="st">&quot;3$&quot;</span> ../outbreak_cluster_identification/poppunk/poppunk_clusters.csv <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d,</span> <span class="at">-f1</span><span class="op">)</span> <span class="op">&lt;(</span><span class="fu">grep</span> <span class="st">&quot;3$&quot;</span> ../outbreak_cluster_identification/poppunk/poppunk_clusters.csv <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d,</span> <span class="at">-f1</span> <span class="kw">|</span> <span class="fu">perl</span> <span class="at">-ne</span> <span class="st">&#39;chomp; print &quot;../assemblies/$_.fa\n&quot;&#39;</span> <span class="op">)</span> <span class="op">&gt;</span> ska_input</span>
<span id="cb61-3"><a href="module-4-outbreak-analysis.html#cb61-3" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;SASCBU26\t../SASCBU26_reference.fna&quot;</span> <span class="op">&gt;&gt;</span> ska_input</span></code></pre></div>
<p>Now we need to generate an SKA index:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb62-1"><a href="module-4-outbreak-analysis.html#cb62-1" tabindex="-1"></a><span class="ex">ska</span> build <span class="at">-f</span> ska_input <span class="at">-k</span> 31 <span class="at">-o</span> ska_index <span class="at">--threads</span> 4</span></code></pre></div>
<p>Then map these split k-mers against the reference (required to order them for the next step):</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb63-1"><a href="module-4-outbreak-analysis.html#cb63-1" tabindex="-1"></a><span class="ex">ska</span> map <span class="at">-o</span> ska.aln <span class="at">--ambig-mask</span> ../SASCBU26_reference.fna ska_index.skf</span></code></pre></div>
<p>This gives us an alignment but due the distorting effects of recombination we typically want to try and remove any potential recombinant sites from the alignment. There are several tools that can help us do this (<code>verticall</code>, <code>ClonalFrameML</code>, <code>gubbins</code>) and today we are going to use <code>gubbins</code>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb64-1"><a href="module-4-outbreak-analysis.html#cb64-1" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> gubbins</span>
<span id="cb64-2"><a href="module-4-outbreak-analysis.html#cb64-2" tabindex="-1"></a><span class="ex">run_gubbins.py</span> <span class="at">--prefix</span> gubbins/gubbins ska.aln</span>
<span id="cb64-3"><a href="module-4-outbreak-analysis.html#cb64-3" tabindex="-1"></a><span class="ex">mask_gubbins_aln.py</span> <span class="at">--aln</span> ska.aln <span class="at">--gff</span> gubbins/gubbins.recombination_predictions.gff <span class="at">--out</span> gubbins.masked.aln</span></code></pre></div>
<p>Now that we have a masked alignment <code>gubbins.masked.aln</code> we can analyse the SNP network using <a href="https://graphsnp.fordelab.com/">GraphSNP</a> to further refine our potential outbreak samples. First, generate a SNP distance matrix using <code>snp-dists</code>:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb65-1"><a href="module-4-outbreak-analysis.html#cb65-1" tabindex="-1"></a><span class="ex">snp-dists</span> gubbins.masked.aln <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/\t/,/g&#39;</span> <span class="op">&gt;</span> raw_outbreak_matrix.csv</span></code></pre></div>
<p>Now download the <code>raw_outbreak_matrix.csv</code>, navigate to <a href="https://graphsnp.fordelab.com/">GraphSNP</a> in your browser, and upload the <code>raw_outbreak_matrix.csv</code> as your Alignment/matrix.</p>
<p><img src="content-files/graphsnp_upload.jpg" /><!-- --></p>
<p>Then click on “Graph” at the top of the page (may be hidden behind 3 horizontal lines on smaller screens), increase your “Cutoff number” to 50, and then hit the “Create Graph” button.</p>
<p><img src="content-files/graphsnp_cluster.jpg" /><!-- --></p>
<p>This will create a minimum spanning tree grouped using a 50 SNP cut-off.</p>
<p><strong>Which genomes do you think you can eliminate from being part of these immediate outbreak cluster?</strong></p>
<details class="callout-dropdown callout-green"><summary class="callout-dropdown-summary"><i class="fas fa-circle-check" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<span class="callout-dropdown-title">Answer</span> <span class="callout-dropdown-caret"><i class="fas fa-chevron-right" aria-hidden="true"></i></span></summary><div class="callout-dropdown-content"><p>Based on the graph, isolates P29 &amp; P34-P38 can be eliminated.
These were the ST22 isolates identified by <code>mlst</code> that
poppunk convinced us to look at a bit more closely. We can see the
closest is only ~80 SNPs from our outbreak cluster.</p></div></details>
<p>Let’s also look at these isolates using a traditional phylogenetic approach. Go back to the server and run the following command to build a maximum-likelihood tree using <code>iqtree</code>:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb66-1"><a href="module-4-outbreak-analysis.html#cb66-1" tabindex="-1"></a><span class="ex">iqtree</span> <span class="at">-s</span> gubbins.masked.aln</span></code></pre></div>
<p>This will generate a lot of outputs but if you download the newick formatted phylogeny <code>gubbins.masked.aln.treefile</code> and go to <a href="https://microreact.org/upload">microreact</a> we can visualise the tree.</p>
<p>Hit the “Upload” button and select your treefile.
<img src="content-files/microreact_upload.jpg" /><!-- --></p>
<p><img src="content-files/microreact_upload2.jpg" /><!-- --></p>
<p>Then hit the settings slider icon at the top right</p>
<p><img src="content-files/microreact_upload3.jpg" /><!-- --></p>
<p>Finally, select radial/unrooted tree.</p>
<p><img src="content-files/microreact_upload4.jpg" /><!-- --></p>
<p><strong>Does the phylogeny show the same genomes as being outside the main outbreak cluster</strong></p>
<details class="callout-dropdown callout-green"><summary class="callout-dropdown-summary"><i class="fas fa-circle-check" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<span class="callout-dropdown-title">Answer</span> <span class="callout-dropdown-caret"><i class="fas fa-chevron-right" aria-hidden="true"></i></span></summary><div class="callout-dropdown-content"><p>Yes, P37 &amp; P38 are close to the main outbreak cluster and could
be included but for now we will exclude them.</p></div></details>
<p>Now we have refined our final set of suspected outbreak isolates we can create our final alignment of just these sequences.</p>
<p><strong>Create a SNP distance matrix and phylogeny for just the final outbreak isolates by repeating the above steps with a modified ska_input (if you create a new folder you’ll avoid getting mixed up with your new datas).</strong></p>
<details class="callout-dropdown callout-subtle callout-blue-subtle"><summary class="callout-dropdown-summary"><i class="fas fa-circle-info" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<span class="callout-dropdown-title">If stuck/time-crunched</span> <span class="callout-dropdown-caret"><i class="fas fa-chevron-right" aria-hidden="true"></i></span></summary><div class="callout-dropdown-content"><p>A pre-computed distance matrix and phylogeny can be copied from
<code>~/CourseData/module4/refined_outbreak_matrix.csv</code> and
<code>~/CourseData/module4/refined.gubbins.masked.aln.treefile</code></p></div></details>
<p><a name="trans"></a>
### Transmission Inference</p>
<p>With our refined outbreak distance matrix and phylogeny we are going to perform some transmission analyses by combining these with some of our context data.</p>
<p>First we are going to use the <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC3183872/">SeqTrack</a> method as implemented in <a href="https://graphsnp.fordelab.com/">GraphSNP</a>.</p>
<p>To do this download <code>contextual_metadata.csv</code> and your refined distance matrix (e.g., <code>refined_outbreak_matrix.csv</code> or whatever you have named it) and then navigate to <a href="https://graphsnp.fordelab.com/">GraphSNP</a>.<br />
This time you must upload the new distance matrix under Alignment/matrix and the metadata table under Metadata.</p>
<p><img src="content-files/graphsnp_upload.jpg" /><!-- --></p>
<p>Then navigate to “Graph” but this time select analysis type “transmission” and click “Create Graph”</p>
<p><img src="content-files/graphsnp_transmission.jpg" /><!-- --></p>
<p><strong>Which person is inferred to have infected the largest number of other patients?</strong></p>
<details class="callout-dropdown callout-green"><summary class="callout-dropdown-summary"><i class="fas fa-circle-check" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<span class="callout-dropdown-title">Answer</span> <span class="callout-dropdown-caret"><i class="fas fa-chevron-right" aria-hidden="true"></i></span></summary><div class="callout-dropdown-content"><p>P8 or P4</p></div></details>
<p><strong>Which baby/babies was/were inferred to be infected by a parent?</strong></p>
<details class="callout-dropdown callout-green"><summary class="callout-dropdown-summary"><i class="fas fa-circle-check" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<span class="callout-dropdown-title">Answer</span> <span class="callout-dropdown-caret"><i class="fas fa-chevron-right" aria-hidden="true"></i></span></summary><div class="callout-dropdown-content"><p>P13 and P15</p></div></details>
<div class="callout-purple">
<span class="callout-icon"><i class="fas fa-star" aria-hidden="true"></i></span>
<div class="callout-content">
<p>Congratulations you’ve performed your first transmission analysis!</p>
</div>
</div>
<p>The next step would be to try and perform a more sophisticated transmission inference method using <code>TransPhylo</code>.
However, this would require us to infer a time-scaled phylogeny and you’ll discover more about how to do that in the next module!</p>
<!--
```R
library(BactDating)
dist_tree <- ape::read.tree("~/workspace/module4/PATH_TO_FINAL_IQTREE.tre")

dates <- read.csv("~/CourseData/module4/contextual_data.csv") 
rownames(dates) <- dates$sample_id
dates <- lubridate::decimal_date(lubridate::ymd(dates[dist_tree$tip.label, "collection_date"]))
res <- roottotip(dist_tree, dates)
res <- bactdate(ape::unroot(dist_tree),dates,nbIts=1000)
plot(res,'treeCI',show.tip.label = F)
ttree <- res$tree
```

Now we can use transphylo to perform transmission inference

```R
library(TransPhylo)
ptree<-ptreeFromPhylo(ttree,dateLastSample=max(dates))
```
-->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="module-3-pathogen-typing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="module-5-phylodynamics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bioinformaticsdotca//blob/main/040-module-4.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
